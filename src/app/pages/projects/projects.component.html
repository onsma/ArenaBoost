<!-- Projects Header -->
<section class="bg-dark text-white py-5">
  <div class="container py-4">
    <h1 class="display-4 fw-bold mb-4 text-white">Projects</h1>
    <p class="lead text-white">Discover exciting sports projects seeking investment and support on ArenaBoost.</p>
  </div>
</section>

<!-- Category Filter -->
<section class="py-4 bg-light">
  <div class="container">
    <div class="d-flex flex-wrap justify-content-center gap-2">
      <button class="btn" [ngClass]="{'btn-warning': !selectedCategory, 'btn-outline-dark': selectedCategory}"
        (click)="filterByCategory('')">
        All Projects
      </button>
      <button *ngFor="let category of categories" class="btn"
        [ngClass]="{'btn-warning': selectedCategory === category, 'btn-outline-dark': selectedCategory !== category}"
        (click)="filterByCategory(category)">
        {{ category }}
      </button>
    </div>
  </div>
</section>

<!-- Projects List -->
<section class="py-5 bg-dark text-white">
  <div class="container py-4">
    <!-- Loading State -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-warning" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-white">Loading projects...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading && projects.length === 0" class="text-center py-5">
      <div class="alert alert-danger">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        There was an error loading projects. Please try again later.
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && projects.length === 0" class="border border-secondary rounded p-5 text-center">
      <p class="mb-0 text-white">No projects found. Please try a different category or check back later.</p>
    </div>

    <!-- Projects Grid -->
    <div *ngIf="!loading && projects.length > 0" class="row g-4">
      <div *ngFor="let project of projects" class="col-md-6 col-lg-4">
        <div class="card h-100 border-0 shadow">
          <div class="position-relative">
            <img [src]="project.imageUrl || '/assets/images/soccer-field-night.jpg'" [alt]="project.name"
              class="card-img-top" style="height: 200px; object-fit: cover;">
            <div class="position-absolute top-0 end-0 m-2">
              <span class="badge bg-warning text-dark">{{ project.category }}</span>
            </div>
          </div>
          <div class="card-body">
            <h5 class="card-title text-dark">{{ project.name }}</h5>
            <p class="card-text text-muted">{{ project.description | slice:0:100 }}{{ project.description.length > 100 ?
              '...' : '' }}</p>

            <div class="d-flex justify-content-between align-items-center mb-2">
              <small class="text-muted">Days remaining: {{ project.days_remaining }}</small>
              <small class="text-muted">Started: {{ project.start_date | date }}</small>
            </div>

            <div class="progress mb-3" style="height: 10px;">
              <div class="progress-bar bg-warning" [style.width.%]="getProgressPercentage(project)"
                [attr.aria-valuenow]="getProgressPercentage(project)" aria-valuemin="0" aria-valuemax="100">
              </div>
            </div>

            <div class="d-flex justify-content-between mb-3">
              <span class="fw-bold">{{ project.current_amount | currency }}</span>
              <span class="text-muted">of {{ project.goal_amount | currency }} goal</span>
            </div>

            <div class="d-grid">
              <a [routerLink]="['/projects', project.id_project]" class="btn btn-outline-dark">View Project</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Featured Project Image -->
<section class="py-5">
  <div class="container-fluid p-0">
    <div class="row g-0">
      <div class="col-12">
        <img src="/assets/images/soccer-field-night.jpg" alt="Soccer field at night" class="img-fluid w-100"
          style="max-height: 500px; object-fit: cover;">
      </div>
    </div>
  </div>
</section>

<!-- Create Project CTA -->
<section class="py-5 bg-dark text-white">
  <div class="container py-4 text-center">
    <h2 class="mb-4 text-white">Have a Sports Project in Mind?</h2>
    <p class="lead mb-4 text-white">Create your project on ArenaBoost and connect with investors and supporters who
      share your passion.</p>
    <a routerLink="/projects/create" class="btn btn-warning btn-lg px-5 fw-bold">Create a Project</a>
  </div>
</section>